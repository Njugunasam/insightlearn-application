{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import ProfileDropdown from'./ProfileDropdown';// Import the modified ProfileDropdown component\nimport{useNavigate}from'react-router-dom';// Import useNavigate\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const TaskPage=()=>{const[tasks,setTasks]=useState([]);const[user,setUser]=useState(null);const[newTaskTitle,setNewTaskTitle]=useState('');const[newTaskDescription,setNewTaskDescription]=useState('');const[username,setUsername]=useState('');const navigate=useNavigate();// Initialize navigate\nuseEffect(()=>{const fetchUserData=async token=>{try{const response=await axios.get('http://localhost:8000/user',{headers:{Authorization:\"Bearer \".concat(token)}});setUsername(response.data.username);}catch(error){console.error('Error fetching user data:',error);}};const fetchTasks=async token=>{try{const response=await axios.get('http://localhost:8000/tasks',{headers:{Authorization:\"Bearer \".concat(token)}});setTasks(response.data);}catch(error){console.error('Error fetching tasks:',error);}};const token=localStorage.getItem('token');if(token){setUser(true);fetchUserData(token);fetchTasks(token);}else{setUser(false);}},[]);const handleAddTask=async e=>{e.preventDefault();try{const token=localStorage.getItem('token');const response=await axios.post('http://localhost:8000/tasks/add',{title:newTaskTitle,description:newTaskDescription},{headers:{Authorization:\"Bearer \".concat(token)}});response.data.id=Math.random().toString(36).substr(2,9);setTasks(prevTasks=>[...prevTasks,response.data]);setNewTaskTitle('');setNewTaskDescription('');}catch(error){console.error('Error adding task:',error);}};const handleLogout=()=>{localStorage.removeItem('token');setUser(false);navigate('/');// Redirect to the homepage using navigate\n};return/*#__PURE__*/_jsx(\"div\",{className:\"task-page-container\",children:user?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-profile-section\",children:/*#__PURE__*/_jsx(ProfileDropdown,{username:username,onLogout:handleLogout})}),/*#__PURE__*/_jsxs(\"div\",{className:\"task-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"task-form\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Add New Task\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddTask,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",value:newTaskTitle,onChange:e=>setNewTaskTitle(e.target.value),required:true}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Description\",value:newTaskDescription,onChange:e=>setNewTaskDescription(e.target.value),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Add Task\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"task-list\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Tasks\"}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Description\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:tasks.map(task=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:task.title}),/*#__PURE__*/_jsx(\"td\",{children:task.description})]},task.id))})]})]})]})]}):/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"})});};export default TaskPage;","map":{"version":3,"names":["React","useState","useEffect","axios","ProfileDropdown","useNavigate","jsx","_jsx","jsxs","_jsxs","TaskPage","tasks","setTasks","user","setUser","newTaskTitle","setNewTaskTitle","newTaskDescription","setNewTaskDescription","username","setUsername","navigate","fetchUserData","token","response","get","headers","Authorization","concat","data","error","console","fetchTasks","localStorage","getItem","handleAddTask","e","preventDefault","post","title","description","id","Math","random","toString","substr","prevTasks","handleLogout","removeItem","className","children","onLogout","onSubmit","type","placeholder","value","onChange","target","required","map","task"],"sources":["/home/sam-njuguna/moringa/phase4/task-management-app/src/TaskPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport ProfileDropdown from './ProfileDropdown'; // Import the modified ProfileDropdown component\nimport { useNavigate } from 'react-router-dom'; // Import useNavigate\n\nconst TaskPage = () => {\n  const [tasks, setTasks] = useState([]);\n  const [user, setUser] = useState(null);\n  const [newTaskTitle, setNewTaskTitle] = useState('');\n  const [newTaskDescription, setNewTaskDescription] = useState('');\n  const [username, setUsername] = useState('');\n  const navigate = useNavigate(); // Initialize navigate\n\n  useEffect(() => {\n    const fetchUserData = async (token) => {\n      try {\n        const response = await axios.get('http://localhost:8000/user', {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        setUsername(response.data.username);\n      } catch (error) {\n        console.error('Error fetching user data:', error);\n      }\n    };\n\n    const fetchTasks = async (token) => {\n      try {\n        const response = await axios.get('http://localhost:8000/tasks', {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        setTasks(response.data);\n      } catch (error) {\n        console.error('Error fetching tasks:', error);\n      }\n    };\n\n    const token = localStorage.getItem('token');\n    if (token) {\n      setUser(true);\n      fetchUserData(token);\n      fetchTasks(token);\n    } else {\n      setUser(false);\n    }\n  }, []);\n\n  const handleAddTask = async (e) => {\n    e.preventDefault();\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.post(\n        'http://localhost:8000/tasks/add',\n        {\n          title: newTaskTitle,\n          description: newTaskDescription\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        }\n      );\n      response.data.id = Math.random().toString(36).substr(2, 9);\n      setTasks(prevTasks => [...prevTasks, response.data]);\n      setNewTaskTitle('');\n      setNewTaskDescription('');\n    } catch (error) {\n      console.error('Error adding task:', error);\n    }\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    setUser(false);\n    navigate('/'); // Redirect to the homepage using navigate\n  };\n\n  return (\n    <div className=\"task-page-container\">\n      {user ? (\n        <div>\n          <div className=\"user-profile-section\">\n            {/* Integrate ProfileDropdown component here */}\n            <ProfileDropdown username={username} onLogout={handleLogout} />\n          </div>\n          <div className=\"task-content\">\n            <div className=\"task-form\">\n              <h2>Add New Task</h2>\n              <form onSubmit={handleAddTask}>\n                <input\n                  type=\"text\"\n                  placeholder=\"Title\"\n                  value={newTaskTitle}\n                  onChange={(e) => setNewTaskTitle(e.target.value)}\n                  required\n                />\n                <textarea\n                  placeholder=\"Description\"\n                  value={newTaskDescription}\n                  onChange={(e) => setNewTaskDescription(e.target.value)}\n                  required\n                />\n                <button type=\"submit\">Add Task</button>\n              </form>\n            </div>\n            <div className=\"task-list\">\n              <h2>Tasks</h2>\n              <table>\n                <thead>\n                  <tr>\n                    <th>Title</th>\n                    <th>Description</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {tasks.map(task => (\n                    <tr key={task.id}>\n                      <td>{task.title}</td>\n                      <td>{task.description}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div>Loading...</div>\n      )}\n    </div>\n  );\n};\n\nexport default TaskPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}